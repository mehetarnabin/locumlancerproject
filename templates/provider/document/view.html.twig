{% extends 'provider/base.html.twig' %}

{% block title %}View Document{% endblock %}

{% block provider_body %}
<style>
/* Override container-xl to shift content left and remove left spacing */
.container-xl {
    margin-left: 0 !important;
    padding-left: 0 !important;
    max-width: 100% !important;
    transform: translateX(-80px) !important;
}

/* Override app-content padding from base template to remove left spacing */
.app-content {
    padding-left: 0 !important;
}

.document-viewer-container {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 6px 18px rgba(16,24,40,0.06);
    padding: 0;
    display: flex;
    flex-direction: column;
    height: calc(100vh - 120px);
    margin: 20px;
}

.document-viewer-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 24px;
    border-bottom: 1px solid #e6eef6;
    background: #fff;
    border-radius: 12px 12px 0 0;
}

.document-viewer-title {
    display: flex;
    align-items: center;
    gap: 12px;
}

.document-viewer-title h4 {
    font-size: 18px;
    font-weight: 600;
    color: #121C0C;
    margin: 0;
}

.document-viewer-meta {
    display: flex;
    gap: 16px;
    align-items: center;
    font-size: 13px;
    color: #6b7280;
}

.document-viewer-actions {
    display: flex;
    gap: 8px;
    align-items: center;
}

.action-btn {
    min-width: 36px;
    min-height: 36px;
    padding: 8px 12px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    border-radius: 6px;
    background: #F4F9F1;
    border: 1px solid #e6eef6;
    transition: all 0.2s ease;
    text-decoration: none;
    font-size: 13px;
    color: #374151;
    cursor: pointer;
}

.action-btn:hover {
    background: #85BB65;
    border-color: #85BB65;
    color: #fff;
    transform: translateY(-1px);
}

.action-btn svg {
    width: 18px;
    height: 18px;
}

.document-viewer-body {
    flex: 1;
    padding: 24px;
    overflow: auto;
    background: #f9fafb;
    display: flex;
    align-items: center;
    justify-content: center;
}

.document-preview-wrapper {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: #fff;
    border: 1px solid #e6eef6;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(11,22,40,0.08);
}

.document-preview-frame {
    width: 100%;
    height: 100%;
    border: none;
    background: #fff;
}

.document-preview-frame iframe,
.document-preview-frame embed,
.document-preview-frame object {
    width: 100%;
    height: 100%;
    border: none;
}

.document-preview-frame img {
    width: 100%;
    height: auto;
    max-height: 100%;
    object-fit: contain;
    display: block;
}

.document-preview-unsupported {
    padding: 60px 40px;
    text-align: center;
    color: #6b7280;
}

.document-preview-unsupported svg {
    width: 64px;
    height: 64px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.document-preview-unsupported h5 {
    font-size: 18px;
    font-weight: 600;
    color: #374151;
    margin-bottom: 8px;
}

.document-preview-unsupported p {
    font-size: 14px;
    color: #6b7280;
    margin-bottom: 20px;
}

.back-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: #F4F9F1;
    border: 1px solid #e6eef6;
    border-radius: 6px;
    color: #374151;
    text-decoration: none;
    font-size: 13px;
    transition: all 0.2s ease;
    margin-bottom: 20px;
    margin-left: 20px;
    margin-top: 20px;
}

.back-btn:hover {
    background: #85BB65;
    border-color: #85BB65;
    color: #fff;
}

.back-btn svg {
    width: 16px;
    height: 16px;
}
</style>

<a href="{{ path('app_provider_documents') }}" class="back-btn">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    Back to Documents
</a>

<div class="document-viewer-container">
    <div class="document-viewer-header">
        <div class="document-viewer-title">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h4>{{ document.name }}</h4>
        </div>
        <div class="document-viewer-meta">
            {% if document.category %}
                <span class="category-badge" style="display: inline-block; padding: 4px 12px; border-radius: 999px; font-size: 0.75rem; font-weight: 500; background: #EAF3E4; color: #4B5563;">
                    {{ document.category }}
                </span>
            {% endif %}
            {% if document.issueDate %}
                <span>Issue: {{ document.issueDate|date('m/d/Y') }}</span>
            {% endif %}
            {% if document.expirationDate %}
                <span>Expires: {{ document.expirationDate|date('m/d/Y') }}</span>
            {% endif %}
        </div>
        <div class="document-viewer-actions">
            <a href="{{ documentUrl }}" target="_blank" class="action-btn" title="Open in New Tab">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13 3H21V11M21 3L11 13M21 3V7M21 3H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Open in New Tab
            </a>
            <a href="{{ path('app_provider_document_edit', {'id': document.id}) }}" class="action-btn" title="Edit Document">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M18.5 2.5C18.8978 2.10218 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10218 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10218 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Edit
            </a>
            <a href="{{ path('app_provider_documents') }}" class="action-btn" title="Back to Documents">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Back
            </a>
        </div>
    </div>
    
    <div class="document-viewer-body">
        <div class="document-preview-wrapper">
            {% set fileExtension = document.fileName|split('.')|last|lower %}
            {% if fileExtension in ['jpg', 'jpeg', 'png', 'gif', 'webp'] %}
                <img src="{{ documentUrl }}" alt="{{ document.name }}" class="document-preview-frame" />
            {% elseif fileExtension == 'pdf' %}
                <iframe src="{{ documentUrl }}" class="document-preview-frame" type="application/pdf"></iframe>
            {% else %}
                <div class="document-preview-unsupported">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <h5>Preview not available</h5>
                    <p>This file type cannot be previewed in the browser.</p>
                    <a href="{{ documentUrl }}" target="_blank" class="action-btn" style="display: inline-flex;">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M13 3H21V11M21 3L11 13M21 3V7M21 3H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Open in New Tab
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}


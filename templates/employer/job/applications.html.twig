{% extends 'employer/base.html.twig' %}

{% block title %}Applications for {{ job.title }}{% endblock %}

{% block employer_body %}
    {% set statusColors = {
        'applied': 'applied',
        'in_review': 'review',
        'interview': 'interview',
        'offered': 'offered',
        'rejected': 'rejected',
        'hired': 'hired',
        'completed': 'completed'
    } %}

    {% set transitionColors = {
        'review': 'review',
        'interview': 'interview',
        'offer': 'offered',
        'reject': 'rejected',
        'hire': 'hired',
        'complete': 'completed'
    } %}

    <div class="container-xl">

        <div class="row">
            <div class="col-12">
                <div class="card application-header">
                    <div class="card-body">
                        <div>
                            <h3><a href="{{ path('app_employer_job_show', {'id': job.id}) }}">{{ job.title }}</a></h3>
                            <p>{{ job.workType }}</p>
                            <p>{{ job.need }}</p>
                            <p>{{ job.schedule }}</p>
                            <p>{{ job.state ~' '~ job.city }}</p>
                            <p>Expires in {{ job.expirationDate ? job.expirationDate|date('m/d/Y')|ago }}</p>
                        </div>
                        <div class="status">
                            <span class="badge badge-pill is-applied">{{ job.status|capitalize }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-2">
            <div class="col-12 col-md-4">
                <div class="left-aside">

                <div class="card application-filter mb-4">
                    <div class="card-body">
                        <form>
                            <div class="col">
                                <select name="status" class="form-control form-select">
                                    <option value="">All</option>
                                    <option value="applied" {% if app.request.get('status') == 'applied' %}selected{% endif %}>Applied</option>
                                    <option value="in_review" {% if app.request.get('status') == 'in_review' %}selected{% endif %}>In Review</option>
                                    <option value="interview" {% if app.request.get('status') == 'interview' %}selected{% endif %}>Interview</option>
                                    <option value="offered" {% if app.request.get('status') == 'offered' %}selected{% endif %}>Offered</option>
                                    <option value="rejected" {% if app.request.get('status') == 'rejected' %}selected{% endif %}>Rejected</option>
                                    <option value="hired" {% if app.request.get('status') == 'hired' %}selected{% endif %}>Hired</option>
                                    <option value="completed" {% if app.request.get('status') == 'completed' %}selected{% endif %}>Completed</option>
                                </select>
                            </div>
                            <div class="col">
                                <input type="submit" value="Filter" class="btn btn-sm" />
                            </div>
                        </form>
                    </div>
                </div>

                {% for application in applications %}
                    {% set provider = application.provider %}
                    {% set user = provider.user %}

                    <a href="{{ path('app_employer_job_applications', {'id': job.id, 'applicationId': application.id}) }}">
                    <div class="card card-v2 {% if app.request.get('applicationId') == application.id or app.request.get('applicationId') is empty and loop.index == 1 %}active-card{% endif %}" id="{{ application.id }}">
                        <div class="card-body">
                            {% if provider.user.profilePicture %}
                                <img src="{{ provider.user.profilePicture }}" width="40px" />
                            {% endif %}
                            <div>
                                <h4>{{ user.name }}</h4>
                                <p><i class="fa fa-clock"></i>{{ application.createdAt|time_diff }}</p>
                                <p><i class="fa fa-star"></i> {{ application.provider.averagePoint ? : 'Not Rated Yet' }}</p>
                                <p><i class="fa fa-map-marked"></i> {{ provider.country~' '~provider.state~' '~provider.city }}</p>
                                <p><i class="fa fa-mobile"></i> {{ provider.phoneMobile }}</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="badge badge-pill is-{{ statusColors[application.status] }}">
                                {{ application.status | replace({'_': ' '}) | title }}
                            </span>
                            <a href="{{ path('app_employer_application_delete', {'id': application.id}) }}" onclick="return confirm('Are you sure? Do you want to delete this application?')"><img src="{{ asset('assets/icons/delete.png') }}" class="icon-image" /></a>
                        </div>
                    </div>
                    </a>
                {% endfor %}
            </div>
            </div>

            {% set application = applicationDetail %}
            {% set provider = application.provider %}

            <div class="col-12 col-md-8">
                <div class="right-aside">
                <div class="card mb-3">
                    <div class="card-body">
                        {% for transition in jobApplicationTransitions[application.id.toString()] %}
                            <a href="{{ path('app_employer_job_application_transition', {id: job.id, transition: transition, applicationId: application.id}) }}"
                               class="btn is-{{ transitionColors[transition] }}"
                               title="{{ transition|capitalize }} Application"
                               onclick="return confirm('Are you sure you want to {{ transition|lower }} this application (Current Status: {{ application.status|capitalize }})?');"
                            >
                                {{ transition|capitalize }}
                            </a>
{#                        {% else %}#}
{#                            <span class="badge bg-{{ statusColors[application.status] ?? 'primary' }}">{{ application.status }}</span>#}
                        {% endfor %}
                        {% if provider.cvFilename %}
                            <a href="{{ path('app_employer_application_download_resume', {'id': application.id}) }}" 
                               class="btn btn-primary">
                               ðŸ“¥ Download Resume
                            </a>
                        {% endif %}
                    </div>
                </div>

                <div class="card card-v2 mb-3">
                    <div class="card-body">
                        <div>
                            {% if provider.user.profilePicture %}
                                <img src="{{ provider.user.profilePicture }}" width="40px" />
                            {% endif %}
                            <div>
                                <h3>{{ provider.user.name }}'s Application</h3>
                                <p><i class="fa fa-clock"></i>{{ application.createdAt|time_diff }}</p>
                                <p><i class="fa fa-star"></i> {{ application.provider.averagePoint ? : 'Not Rated Yet' }}</p>
                            </div>
                        </div>
                        <span class="badge badge-pill is-{{ statusColors[application.status] }}">
                            {{ application.status | replace({'_': ' '}) | title }}
                        </span>
                    </div>

                    <!-- Actions -->
                    <div class="row mt-3">
                        <div class="col mb-3">
                            {% if application.oneFileRequestedAt is null and application.status in ['applied', 'in_review', 'interview', 'offered', 'hired'] %}
                                <a href="{{ path('app_employer_application_askforonefile', {'id': application.id}) }}" title="Request One File">
                                    <img src="{{ asset('assets/icons/folder.png') }}" class="icon-image" alt="summary" />
                                </a>
                            {% endif %}

                            {% if application.status in ['interview', 'offered', 'hired'] %}
                                <a href="#askDocumentModal" data-bs-toggle="modal" title="Request Document">
                                    &nbsp; <img src="{{ asset('assets/icons/request.png') }}" class="icon-image" />
                                </a>
                            {% endif %}

                            {% if application.status == 'interview' and application.interview is null %}
                                <a href="#interviewModal" data-bs-toggle="modal" title="Schedule Interview">
                                    &nbsp; <img src="{{ asset('assets/icons/online-discussion.png') }}" class="icon-image" />
                                </a>
                            {% endif %}

                            {% if application.contractSentAt is null and application.status in ['offered'] %}
                                <a href="#" data-toggle="modal" data-target="#contractModal" title="Send Contract">
                                    &nbsp; <img src="{{ asset('assets/icons/contract.png') }}" class="icon-image" />
                                </a>
                            {% endif %}

                            {% if review is null and applicationDetail.status == 'completed' %}
                                <a href="#" data-toggle="modal" data-target="#reviewModal" title="Write a Review">
                                    &nbsp; <img src="{{ asset('assets/icons/customer-review.png') }}" class="icon-image" />
                                </a>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Actions History -->
                    <div class="row mt-3">
                        <div class="col mb-3">
                            {% if application.oneFileRequestedAt %}
                                One File Requested On: {{ application.oneFileRequestedAt|date('m/d/Y') }}
                            {% endif %}
                            {% if application.oneFileProvidedAt %}
                                <br/>
                                One File Provided On: {{ application.oneFileProvidedAt|date('m/d/Y') }}
                            {% endif %}
                        </div>

                        {% if application.interview is not null %}
                            <div class="col mb-3">
                                Interview Scheduled For: {{ application.interview.date|date('m/d/Y H:i') }}
                            </div>
                        {% endif %}

                        <div class="col mb-3">
                            {% if application.contractSentAt is not null %}
                                Contract Sent On: {{ application.contractSentAt|date('m/d/Y') }}
                            {% endif %}
                            {% if application.contractSignedAt %}
                                <br/>
                                Contract Signed On: {{ application.contractSignedAt|date('m/d/Y') }}
                            {% endif %}
                        </div>

                        {% if review %}
                            <div class="col mb-3">
                                Reviewed On: {{ review.createdAt|date('m/d/Y') }}
                            </div>
                        {% endif %}
                    </div>

                </div>

                    <!-- CV -->
                    {% if  provider.cvFilename %}
                    <div class="row">
                    <div class="col-lg-12 mb-4">
                        <h5 class="mb-3 summary-title">CV</h5>
                        <div class="card summary-card shadow-sm border-light">
                            <div class="card-body p-2">
                                <a href="#" data-bs-toggle="modal" data-bs-target="#previewModal{{ provider.id }}" title="Preview">
                                    <img src="{{ asset('assets/icons/download.png') }}" class="icon-image">
                                </a> &nbsp;  {{ provider.cvFilename }}

                                <!-- Modal -->
                                <div class="modal fade" id="previewModal{{ provider.id }}" tabindex="-1" aria-labelledby="previewModalLabel{{ provider.id }}" aria-hidden="true">
                                    <div class="modal-dialog modal-xl">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="previewModalLabel{{ provider.id }}">File Preview - {{ provider.cvFilename }}</h5>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                {% set filePath = asset('uploads/' ~ provider.user.id ~ '/' ~ provider.cvFilename) %}
                                                {% if provider.cvFilename ends with '.pdf' %}
                                                    <iframe src="{{ filePath }}" width="100%" height="600px" style="border: none;"></iframe>
                                                {% else %}
                                                    <div class="text-center">
                                                        <p><strong>This file type cannot be previewed.</strong></p>
                                                        <a href="{{ filePath }}" class="btn btn-primary" target="_blank" download>Download {{ provider.cvFilename }}</a>
                                                    </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}

                    <!-- Document Requests -->
                    {% if documentRequests|length > 0 %}
                        <div class="row">
                            <div class="col-md-12">
                                <h5 class="mb-3 summary-title">Documents</h5>
                                <table class="table">
                                    <tr>
                                        <th>SN</th>
                                        <th>Name</th>
                                        <th>Requested At</th>
                                        <th>Provided At</th>
                                        <th>File</th>
                                    </tr>
                                    {% for documentRequest in documentRequests %}
                                        {% set document = documentRequest.document %}
                                        <tr>
                                            <td>{{ loop.index }}</td>
                                            <td>{{ documentRequest.name }}</td>
                                            <td>{{ documentRequest.createdAt|date('m/d/Y') }}</td>
                                            <td>{{ documentRequest.providedAt ? documentRequest.providedAt|date('m/d/Y') : '-' }}</td>
                                            <td>
                                                {% if document %}
                                                    <a href="{{ asset('uploads/' ~ document.user.id ~ '/' ~ document.fileName) }}" target="_blank">
                                                        {{ document.fileName }}
                                                    </a>
                                                {% else %}
                                                    -
                                                {% endif %}
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </table>
                            </div>
                        </div>
                    {% endif %}

                    <!-- Contracts -->
                    {% if application.contractFileName or application.contractSignedFileName %}
                        <div class="row">
                            <!-- Contracts -->
                            <h5 class="mb-3 summary-title">Contracts</h5>
                            <div class="col-md-12 col-sm-6">
                                <div class="card summary-card shadow-sm border-light mb-3">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            {% if application.contractFileName %}
                                                <li><strong>Contract File:</strong>
                                                    <a href="{{ asset('uploads/contracts/' ~ application.contractFileName) }}" target="_blank">
                                                        {{ application.contractFileName }}
                                                    </a>
                                                </li>
                                            {% endif %}
                                            {% if application.contractSignedFileName %}
                                                <li><strong>Signed Contract File:</strong>
                                                    <a href="{{ asset('uploads/contracts/' ~ application.contractSignedFileName) }}" target="_blank">
                                                        {{ application.contractSignedFileName }}
                                                    </a>
                                                </li>
                                            {% endif %}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}

                    <!-- One File -->
                    {% if application.oneFileProvidedAt %}
                    <div class="row">
                        <!-- Basic Information -->
                        <div class="col-lg-12 mb-4">
                            <h5 class="mb-3 summary-title">Basic Information</h5>
                            <div class="card summary-card shadow-sm border-light">
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li><strong>Name:</strong> {{ provider.name }}</li>
                                        <li><strong>Suffix:</strong> {{ provider.suffix }}</li>
                                        <li><strong>Title:</strong> {{ provider.title }}</li>
                                        <li><strong>NPI Number:</strong> {{ provider.npiNumber }}</li>
                                        <li><strong>Date of Birth:</strong> {{ provider.dob | date("m/d/Y") }}</li>
                                        <li><strong>SSN:</strong> {{ provider.ssn }}</li>
                                        <li><strong>Country of Birth:</strong> {{ provider.countryOfBirth }}</li>
                                        <li><strong>State of Birth:</strong> {{ provider.stateOfBirth }}</li>
                                        <li><strong>City of Birth:</strong> {{ provider.cityOfBirth }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Information -->
                        <div class="col-lg-12 mb-4">
                            <h5 class="mb-3 summary-title">Contact Information</h5>
                            <div class="card summary-card shadow-sm border-light">
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li><strong>Phone (Home):</strong> {{ provider.phoneHome }}</li>
                                        <li><strong>Phone (Work):</strong> {{ provider.phoneWork }}</li>
                                        <li><strong>Phone (Mobile):</strong> {{ provider.phoneMobile }}</li>
                                        <li><strong>Street Address:</strong> {{ provider.streetAddress }}</li>
                                        <li><strong>City:</strong> {{ provider.city }}</li>
                                        <li><strong>State:</strong> {{ provider.state }}</li>
                                        <li><strong>Country:</strong> {{ provider.country }}</li>
                                        <li><strong>Zip Code:</strong> {{ provider.zipCode }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-12 mb-4">
                            <h5 class="mb-3 summary-title">Work Preferences</h5>
                            <div class="card summary-card shadow-sm border-light">
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li><strong>Desired Pay Rate:</strong> {{ provider.desiredPayRate }}</li>
                                        <li><strong>Hourly Rate:</strong> {{ provider.payRateHourly }}</li>
                                        <li><strong>Daily Rate:</strong> {{ provider.payRateDaily }}</li>
                                        <li><strong>Desired Hours:</strong> {{ provider.desiredHour }}</li>
                                        <li><strong>Preferred Patient Volume:</strong> {{ provider.preferredPatientVolume }}</li>
                                        <li><strong>Willing to Travel:</strong> {{ provider.willingToTravel ? 'Yes' : 'No' }}</li>
                                        <li><strong>Availability to
                                                Start:</strong> {{ provider.availabilityToStart | date("m/d/Y") }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <h5 class="mb-3 summary-title">Education & Training</h5>
                        {% for education in educations %}
                            <div class="col-md-12 col-sm-6">
                                <div class="card summary-card shadow-sm border-light mb-3">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li><strong>School:</strong> {{ education.school }}</li>
                                            <li><strong>Degree:</strong> {{ education.degree }}</li>
                                            <li><strong>Field of Study:</strong> {{ education.fieldOfStudy }}</li>
                                            <li><strong>Start Date:</strong> {{ education.startDate | date("m/d/Y") }}</li>
                                            <li><strong>End Date:</strong> {{ education.endDate | date("m/d/Y") }}</li>
                                            <li><strong>Grade:</strong> {{ education.grade }}</li>
                                            <li><strong>Description:</strong> {{ education.description }}</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>

                    <div class="row">
                        <!-- Work History -->
                        <h5 class="mb-3 summary-title">Work History</h5>
                        {% for experience in experiences %}
                            <div class="col-md-12 col-sm-6">
                                <div class="card summary-card shadow-sm border-light mb-3">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li><strong>Title:</strong> {{ experience.title }}</li>
                                            <li><strong>Company:</strong> {{ experience.company }}</li>
                                            <li><strong>Employment Type:</strong> {{ experience.employmentType }}</li>
                                            <li><strong>Start Date:</strong> {{ experience.startDate | date("m/d/Y") }}</li>
                                            <li><strong>End Date:</strong> {{ experience.endDate | date("m/d/Y") }}</li>
                                            <li><strong>Location:</strong> {{ experience.location }}</li>
                                            <li><strong>Location Type:</strong> {{ experience.locationType }}</li>
                                            <li><strong>Description:</strong> {{ experience.description }}</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>

                    <div class="row">
                        <!-- Insurances -->
                        <h5 class="mb-3 summary-title">Insurances</h5>
                        {% for insurance in insurances %}
                            <div class="col-md-12 col-sm-6">
                                <div class="card summary-card shadow-sm border-light mb-3">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li><strong>Carrier:</strong> {{ insurance.carrier }}</li>
                                            <li><strong>Policy Number:</strong> {{ insurance.policyNumber }}</li>
                                            <li><strong>Amount:</strong> {{ insurance.amount }}</li>
                                            <li><strong>State:</strong> {{ insurance.state }}</li>
                                            <li><strong>City:</strong> {{ insurance.city }}</li>
                                            <li><strong>Effective Date:</strong> {{ insurance.effectiveDate | date("m/d/Y") }}
                                            </li>
                                            <li><strong>Expiration Date:</strong> {{ insurance.expirationDate | date("m/d/Y") }}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>

                     <div class="row">
                         <h5 class="mb-3 summary-title">Health Assessment</h5>

                         <div class="col-md-12 col-sm-6">
                            <div class="card summary-card shadow-sm border-light mb-3">
                                <div class="card-body">
                                    {# --- Substance Abuse Question --- #}
                                    <div class="form-group mt-2">
                                        <label for="substance-abuse">Do you currently have any chemical substance abuse dependency?</label>
                                        <div class="radio-group mt-2">
                                            <label>
                                                {% if (healthAssessment and healthAssessment.substance_abuse is defined and healthAssessment.substance_abuse == 'yes') or (healthAssessment is not defined or healthAssessment.substance_abuse is not defined) %}YES{% else %}NO{% endif %}
                                            </label>
                                            <label>
                                                {% if healthAssessment and healthAssessment.substance_abuse_explanation is defined %}
                                                    {{ healthAssessment.substance_abuse_explanation }}
                                                {% endif %}
                                            </label>
                                        </div>
                                    </div>

                                    {# --- Job Related Question --- #}
                                    <div class="form-group mt-4">
                                        <label for="job-related">Are there any reasons that would prevent you from being able to perform competently the job-related functions of a locum tenens physician?</label>
                                        <div class="radio-group mt-2">
                                            <label>
                                                {% if (healthAssessment and healthAssessment.job_related is defined and healthAssessment.job_related == 'yes') or (healthAssessment is not defined or healthAssessment.job_related is not defined) %}YES{% else %}NO{% endif %}
                                            </label>
                                            <label>
                                                {% if healthAssessment and healthAssessment.job_related_explanation is defined %}{{ healthAssessment.job_related_explanation }}{% endif %}
                                            </label>
                                        </div>
                                    </div>

                                    {# --- Travel Question --- #}
                                    <div class="form-group mt-4">
                                        <label for="travel">Are there any reasons that would prevent you from being able to travel and promptly assume locum tenens physician responsibilities in unfamiliar facilities?</label>
                                        <div class="radio-group mt-2">
                                            <label>
                                                {% if (healthAssessment and healthAssessment.travel is defined and healthAssessment.travel == 'yes') or (healthAssessment is not defined or healthAssessment.travel is not defined) %}YES{% else %}NO{% endif %}
                                            </label>
                                            <label>
                                                {% if healthAssessment and healthAssessment.travel_explanation is defined %}{{ healthAssessment.travel_explanation }}{% endif %}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                         </div>
                     </div>

                    <div class="row">
                         <h5 class="mb-3 summary-title">Risk Assessment</h5>

                         <div class="col-md-12 col-sm-6">
                            <div class="card summary-card shadow-sm border-light mb-3">
                                <div class="card-body">
                                    <div class="form-group mt-2">
                                        <label>Can you submit verification of your legal right to work in the U.S.? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.work_verification is defined and riskAssessment.work_verification == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label for="degree">Degree Group *</label>
                                        <br/>
                                        {% if riskAssessment and riskAssessment.degree %}{{ riskAssessment.degree }}{% endif %}
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>In the past 24 months, have you had patient contact practicing in the specialty area for
                                            which you are applying? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.patient_contact is defined and riskAssessment.patient_contact == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have you ever been named in a malpractice claim? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.malpractice_claim is defined and riskAssessment.malpractice_claim == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Has your license to practice in your profession ever been formally investigated,
                                            sanctioned, or revoked? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.license_investigation is defined and riskAssessment.license_investigation == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have you ever been denied provider participation in Medicare/Medicaid? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.medicare_denial is defined and riskAssessment.medicare_denial == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have you ever resigned from a position in lieu of an investigation, or have you ever been
                                            terminated from employment? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.resigned_or_terminated is defined and riskAssessment.resigned_or_terminated == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have your hospital or clinic privileges ever been revoked, suspended, or restricted?
                                            *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.clinic_privileges is defined and riskAssessment.clinic_privileges == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have you ever been disciplined by a hospital staff or professional education program?
                                            *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.disciplinary_action is defined and riskAssessment.disciplinary_action == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have you ever been convicted of a felony or a misdemeanor other than a minor traffic
                                            violation? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.felony_conviction is defined and riskAssessment.felony_conviction == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have you ever abused alcohol, used illegal drugs, or failed to take legally prescribed
                                            drugs? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.substance_abuse is defined and riskAssessment.substance_abuse == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>

                                    <hr/>

                                    <div class="form-group">
                                        <label>Have you incurred or become aware of having a condition that impairs your ability to
                                            practice your medical specialty? *</label>
                                        <div class="radio-group">
                                            <label>{% if riskAssessment and riskAssessment.medical_condition is defined and riskAssessment.medical_condition == 'yes' %}YES{% else %}NO{% endif %}</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                         <h5 class="mb-3 summary-title">Release & Authorization</h5>

                         <div class="col-md-12 col-sm-6">
                            <div class="card summary-card shadow-sm border-light mb-3">
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li><strong>Name:</strong> {{ provider.name }}</li>
                                        <li><strong>Date:</strong> {{ provider.releaseAuthorizationDate ? provider.releaseAuthorizationDate|date("m/d/Y") : '' }}</li>
                                        <li><strong>SSN:</strong> {{ provider.ssn }}</li>
                                        <li><strong>Date of Birth:</strong> {{ provider.dob ? provider.dob|date("m/d/Y") : '' }}</li>
                                        <li><strong>Country of Birth:</strong> {{ provider.countryOfBirth }}</li>
                                        <li><strong>State of Birth:</strong> {{ provider.stateOfBirth }}</li>
                                        <li><strong>City of Birth:</strong> {{ provider.cityOfBirth }}</li>
                                        <li><strong>Release and authorization accepted:</strong> {{ provider.releaseAndAuthorizationAccepted ? "YES" : "NO" }}</li>
                                        <li></li>
                                    </ul>
                                </div>
                            </div>
                         </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

    <!-- Send Contract Modal -->
    <div class="modal fade" id="contractModal" tabindex="-1" role="dialog" aria-labelledby="contractModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="contractModalLabel">Send Contract</h5>
                </div>
                <form method="post" action="{{ path('app_employer_application_sendcontract', {'id': application.id}) }}" enctype="multipart/form-data">
                <div class="modal-body">
                    <div class="form-group">
                        <input type="file" name="contractFile" required />
                    </div>
                </div>
                <div class="modal-footer">
{#                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>#}
                    <button type="submit" class="btn btn-primary">Send</button>
                </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Review Modal -->
    <div class="modal fade" id="reviewModal" tabindex="-1" role="dialog" aria-labelledby="reviewModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reviewModalLabel">Write a Review</h5>
                </div>
                <form method="post" action="{{ path('app_employer_application_review_provider', {'id': application.id}) }}">
                    <div class="modal-body">
                        <div class="form-group mb-3">
                            <label for="message">Message</label>
                            <textarea name="message" class="form-control" required></textarea>
                        </div>

                        {% for label, name in {
                            'Professionalism': 'professionalism',
                            'Quality of Care': 'quality',
                            'Communication': 'communication',
                            'Emotional Intelligence': 'emotional_intelligence'
                        } %}
                            <div class="form-group mb-3">
                                <label>{{ label }}</label>
                                <div class="star-rating">
                                    {% for i in 5..1 %}
                                        <input type="radio" name="{{ name }}" id="{{ name }}-star-{{ i }}" value="{{ i }}" required>
                                        <label for="{{ name }}-star-{{ i }}">â˜…</label>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Submit Review</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Ask Document Modal -->
    <div class="modal fade" id="askDocumentModal" tabindex="-1" aria-labelledby="askDocumentLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="askDocumentLabel">Request Document</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <form action="{{ path('app_employer_application_askfordocument', {'id': applicationDetail.id}) }}" method="POST"> <!-- Change action URL as needed -->
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="documentName" class="form-label">Document Name</label>
                            <input type="text" class="form-control" id="documentName" name="document_name" required>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Send Request</button>
                    </div>
                </form>

            </div>
        </div>
    </div>

    <!-- Interview Modal -->
    <div class="modal fade" id="interviewModal" tabindex="-1" aria-labelledby="interviewLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="interviewLabel">Schedule Interview</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <form action="{{ path('app_employer_application_scheduleinterview', {'id': applicationDetail.id}) }}" method="POST">
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="meeting_date" class="form-label">Meeting Date</label>
                            <input type="text" class="form-control js-datepicker" id="meeting_date" name="meeting_date" required>
                        </div>
                        <div class="mb-3">
                            <label for="meeting_platform" class="form-label">Meeting Platform</label>
                            <select class="form-control" id="meeting_platform" name="meeting_platform" required>
                                <option value="">Choose Platform</option>
                                <option value="Zoom">Zoom</option>
                                <option value="Microsoft Teams">Microsoft Teams</option>
                                <option value="Google Meet">Google Meet</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="meeting_url" class="form-label">Meeting URL</label>
                            <input type="url" class="form-control" id="meeting_url" name="meeting_url" required>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary">Send Schedule</button>
                    </div>
                </form>

            </div>
        </div>
    </div>

{% endblock %}

{% block footer_scripts %}
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

    <script>
        $(".js-datepicker").flatpickr({
            enableTime: true,
            dateFormat: "Y-m-d H:i",
            time_24hr: true // optional: use 24-hour format
        });
    </script>

    <style>
        .star-rating {
            direction: rtl;
            display: inline-flex;
            gap: 0.25rem; /* Optional spacing */
        }

        .star-rating input[type="radio"] {
            display: none;
        }

        .star-rating label {
            font-size: 1.5rem; /* Moved here to apply directly to the stars */
            color: #ccc;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .star-rating input[type="radio"]:checked ~ label,
        .star-rating label:hover,
        .star-rating label:hover ~ label {
            color: #f5b301;
        }
    </style>

{% endblock %}
{% extends 'admin/base.html.twig' %}

{% block title %}Job Detail{% endblock %}

{% block admin_body %}
<div class="container-xl">

    <h1 class="app-page-title">Job Detail</h1>

    <div class="mb-4">
        <a href="javascript:void(0);" onclick="printJobDetail()" title="Print">
            <img src="{{ asset('assets/icons/printer.png') }}" class="icon-image" />
        </a> &nbsp; &nbsp;
        {% if job.blocked == false %}
            <a href="{{ path('app_admin_job_block', {'id': job.id}) }}" title="Block">
                <img src="{{ asset('assets/icons/sign.png') }}" class="icon-image" />
            </a>
        {% else %}
            <a href="{{ path('app_admin_job_block', {'id': job.id}) }}" title="Unblock">
                <img src="{{ asset('assets/icons/unlocked.png') }}" class="icon-image" />
            </a>
        {% endif %}
        &nbsp; &nbsp;
        {% if job.verified == false %}
            <a href="{{ path('app_admin_job_verify', {'id': job.id}) }}" title="Verify">
                <img src="{{ asset('assets/icons/check.png') }}" class="icon-image" />
            </a>
        {% else %}
            <a href="{{ path('app_admin_job_verify', {'id': job.id}) }}" title="Unverify">
                <img src="{{ asset('assets/icons/document-close.png') }}" class="icon-image" />
            </a>
        {% endif %}
    </div>

    <div id="job-print-content" class="job-details">
        <div class="job-row">
            <div class="job-label">ID</div>
            <div class="job-value">{{ job.jobId }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Title</div>
            <div class="job-value">{{ job.title }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Employer</div>
            <div class="job-value">{{ job.employer }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Location</div>
            <div class="job-value">{{ job.state }}, {{ job.city }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Schedule</div>
            <div class="job-value">{{ job.schedule }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Start Date</div>
            <div class="job-value">{{ job.startDate ? job.startDate|date('m/d/Y') : '' }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Pay Rate</div>
            <div class="job-value">{{ job.payRate }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Pay Rate Daily</div>
            <div class="job-value">{{ job.payRateDaily }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Pay Rate Hourly</div>
            <div class="job-value">{{ job.payRateHourly }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Work Type</div>
            <div class="job-value">{{ job.workType }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Need</div>
            <div class="job-value">{{ job.need }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Years of Experience</div>
            <div class="job-value">{{ job.yearOfExperience }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Blocked</div>
            <div class="job-value">{{ job.blocked ? 'YES' : 'NO' }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Verified</div>
            <div class="job-value">{{ job.verified ? 'YES' : 'NO' }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Status</div>
            <div class="job-value">{{ job.status }}</div>
        </div>
        <div class="job-row">
            <div class="job-label">Description</div>
            <div class="job-value">
                {{ job.description|raw }}
            </div>
        </div>
    </div>

    {% if jobReports|length > 0 %}
    <div class="table-responsive mt-5">
        <h4>Reports</h4>
        <table class="table">
            <tr>
                <th>SN</th>
                <th>User</th>
                <th>Report</th>
                <th>Created At</th>
            </tr>
            {% for jobReport in jobReports %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ jobReport.user.name }}</td>
                <td>{{ jobReport.text }}</td>
                <td>{{ jobReport.createdAt|date('m/d/Y') }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

</div>
{% endblock %}

{% block footer_scripts %}
    <script>
        function printJobDetail() {
            var printContents = document.getElementById('job-print-content').innerHTML;
            var originalContents = document.body.innerHTML;

            document.body.innerHTML = printContents;
            window.print();
            document.body.innerHTML = originalContents;
            location.reload(); // Reload to restore any JS bindings or styles
        }
    </script>
{% endblock %}